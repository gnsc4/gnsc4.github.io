<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torn Modular Bot - User Guide</title>
    <style>
        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0; /* Remove default margin */
            padding: 1rem; /* Add padding */
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 896px; /* Corresponds to max-w-4xl */
            margin-left: auto;
            margin-right: auto;
            padding: 1.5rem; /* Corresponds to p-6 */
            border-radius: 0.5rem; /* Corresponds to rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
        }
        @media (min-width: 768px) { /* md breakpoint */
             body { padding: 2rem; }
             .container { padding: 2.5rem; } /* Corresponds to md:p-10 */
        }

        /* Headings */
        h1, h2, h3 {
            font-weight: 600; /* Semi-bold */
            margin-bottom: 0.5rem;
        }
        h1 {
            font-size: 1.875rem; /* 3xl */
            margin-top: 1.5rem;
            border-bottom-width: 1px;
            padding-bottom: 0.5rem; /* pb-2 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        h2 {
            font-size: 1.5rem; /* 2xl */
            margin-top: 1.25rem;
            border-bottom-width: 1px;
            padding-bottom: 0.25rem; /* pb-1 */
            margin-bottom: 1rem; /* mb-4 */
        }
        h3 {
            font-size: 1.25rem; /* xl */
            margin-top: 1rem;
        }

        /* Paragraphs */
        p {
            margin-bottom: 1rem; /* mb-4 or mb-6 */
        }
        .intro-p {
             margin-bottom: 1.5rem; /* mb-6 */
        }

        /* Lists */
        ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        ol {
            list-style-type: decimal;
            margin-left: 1.5rem;
            margin-top: 0.5rem; /* mt-2 */
            margin-bottom: 1rem;
        }
        li {
            margin-bottom: 0.5rem;
        }

        /* Code blocks */
        code {
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }

        /* Command Sections */
        .command-section {
             padding: 1rem;
             border-radius: 0.5rem;
             margin-bottom: 1rem;
             border-width: 1px;
        }
        .command-section h3 {
            margin-bottom: 0.75rem; /* mb-3 */
        }
        .command-section p {
             margin-top: 0.5rem; /* my-2 */
             margin-bottom: 0.5rem; /* my-2 */
        }

        /* Footer */
        footer {
            text-align: center;
            font-size: 0.875rem; /* text-sm */
            margin-top: 2rem; /* mt-8 */
            padding-top: 1rem; /* pt-4 */
            border-top-width: 1px;
        }

        /* --- Dark Mode Styles --- */
        body {
            background-color: #111827; /* bg-gray-900 */
            color: #d1d5db; /* text-gray-300 */
        }
        .container {
            background-color: #1f2937; /* bg-gray-800 */
        }
        h1, h2, h3 {
             color: #ffffff; /* text-white / text-gray-100 */
        }
        h1, h2, footer {
             border-color: #4b5563; /* border-gray-700 */
        }
        p {
             color: #9ca3af; /* text-gray-400 */
        }
        ul, ol, li {
             color: #d1d5db; /* text-gray-300 */
        }
        code {
            background-color: #374151; /* bg-gray-700 */
            color: #f3f4f6; /* text-gray-100 */
        }
        a {
            color: #60a5fa; /* text-blue-400 */
            text-decoration: underline;
        }
        a:hover {
            color: #93c5fd; /* hover:text-blue-300 */
        }
        .command-section {
             background-color: #1f2937; /* bg-gray-800 */
             border-color: #4b5563; /* border-gray-600 */
        }
        .command-section h3 {
             color: #f3f4f6; /* text-gray-200 */
        }
        .command-section p, .command-section ul, .command-section li {
             color: #d1d5db; /* text-gray-300 */
        }
        footer {
             color: #6b7280; /* text-gray-500 */
             border-color: #374151; /* border-gray-700 */
        }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body> <div class="container"> <h1>Torn Modular Bot - User Guide</h1>

        <p class="intro-p">This guide explains how to use the Torn Modular Bot and its various features within your Discord server.</p>

        <section>
            <h2>For All Users</h2>
            <p>These commands are available to everyone in the server where the bot is active.</p>

            <div class="command-section">
                <h3>1. Adding Your API Key</h3>
                <p>The bot needs your Torn API key to fetch your data for verification, travel monitoring, and other features. Your key is stored securely (encrypted).</p>
                <ul>
                    <li><strong>Command:</strong> <code>/mykey add</code></li>
                    <li><strong>Action:</strong> Opens a pop-up form (modal) where you can securely paste your 16-character Torn API key.</li>
                    <li><strong>How to get a key:</strong> Create one on Torn: <a href="https://www.torn.com/preferences.php#tab=api" target="_blank" rel="noopener noreferrer">https://www.torn.com/preferences.php#tab=api</a> (Requires enabling <code>Public status</code>, <code>Profile information</code>, and <code>Faction tree</code> access for full functionality).</li>
                    <li><strong>Note:</strong> You only need to do this once per server where you use the bot.</li>
                </ul>
            </div>

            <div class="command-section">
                <h3>2. Removing Your API Key</h3>
                <p>If you no longer want the bot to use your key in this specific server:</p>
                <ul>
                    <li><strong>Command:</strong> <code>/mykey remove</code></li>
                    <li><strong>Action:</strong> Removes your stored API key for this server from the bot's database.</li>
                </ul>
            </div>

            <div class="command-section">
                <h3>3. Verifying Your Torn Account</h3>
                <p>Verification links your Discord account to your Torn account within the bot, enabling features like automatic nickname updates and role assignments based on your Torn faction.</p>
                <ul>
                    <li><strong>Prerequisite:</strong> Ensure your Discord account is linked on your Torn profile: <a href="https://www.torn.com/discord" target="_blank" rel="noopener noreferrer">https://www.torn.com/discord</a></li>
                    <li><strong>Command:</strong> <code>/verify</code></li>
                    <li><strong>Action:</strong> The bot checks the Torn API using your Discord ID to find your linked Torn account. If successful, it updates your verification status in the database and may update your nickname and roles according to server settings.</li>
                </ul>
            </div>

             <div class="command-section">
                <h3>4. Re-verifying Your Account</h3>
                <p>If your Torn name, faction, or linked Discord account changes, you might need to re-verify.</p>
                <ul>
                    <li><strong>Command:</strong> <code>/reverify</code></li>
                    <li><strong>Action:</strong> Re-runs the verification check using your Discord ID.</li>
                </ul>
            </div>

            <div class="command-section">
                <h3>5. Setting Up DM Travel Alerts</h3>
                <p>Get Direct Messages when specific monitored players or faction members travel to or arrive from certain countries.</p>
                <ul>
                    <li><strong>Command:</strong> <code>/dmalert</code></li>
                    <li><strong>Action:</strong> Opens an interactive menu:
                        <ol>
                            <li><strong>Select Source:</strong> Choose the Faction or individually Monitored Player you want alerts for.</li>
                            <li><strong>Select Countries:</strong> Choose the specific destination countries you care about, or select "Monitor ALL Countries".</li>
                            <li><strong>Save/Update:</strong> Saves your preferences for the selected source.</li>
                            <li><strong>Remove Alert:</strong> Removes the DM alert setting for the currently selected source.</li>
                            <li><strong>Cancel:</strong> Closes the menu without saving changes.</li>
                        </ol>
                    </li>
                    <li><strong>Note:</strong> You can configure different country settings for each monitored faction or player.</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>For Server Administrators (and Bot Owner)</h2>
            <p>These commands require Administrator permissions in the Discord server (or being the Bot Owner).</p>

            <div class="command-section">
                 <h3>Managing Monitored Factions</h3>
                 <ul>
                    <li><strong>Add Faction:</strong> <code>/faction add</code> - Opens a pop-up to enter the Torn Faction ID to start monitoring.</li>
                    <li><strong>Remove Faction:</strong> <code>/faction remove [faction: Faction ID or Name]</code> - Stops monitoring the specified faction and cleans up related settings.</li>
                    <li><strong>List Factions:</strong> <code>/faction list</code> - Shows all monitored factions and their configured notification settings.</li>
                    <li><strong>Configure Faction Settings:</strong> <code>/faction settings [faction: Faction ID or Name]</code> - Opens a menu to configure Hospital Notifications, Revive List, Travel Notifications/List, and Hospital List settings (channel/role) for the selected faction.</li>
                 </ul>
            </div>

             <div class="command-section">
                 <h3>Managing Monitored Players (Individual)</h3>
                 <ul>
                    <li><strong>Add Player:</strong> <code>/player add [player_id: Torn Player ID]</code> - Starts monitoring an individual player.</li>
                    <li><strong>Remove Player:</strong> <code>/player remove [player_id: Torn Player ID]</code> - Stops monitoring an individual player.</li>
                    <li><strong>List Players:</strong> <code>/player list</code> - Shows all individually monitored players.</li>
                    <li><strong>Set Player Channel:</strong> <code>/player set_channel [player: Player ID or Name]</code> - Sets a specific notification channel for an individual player (overrides faction settings).</li>
                 </ul>
            </div>

            <div class="command-section">
                 <h3>Managing Verification Roles</h3>
                 <ul>
                    <li><strong>Add Faction Role:</strong> <code>/factionrole add [faction_id: Torn Faction ID] [role: Discord Role]</code> - Maps a Faction ID to a Discord role for auto-assignment.</li>
                    <li><strong>Remove Faction Role:</strong> <code>/factionrole remove [faction_id: Faction ID (optional)] [role: Discord Role (optional)]</code> - Removes a mapping (specify ID or Role).</li>
                    <li><strong>List Faction Roles:</strong> <code>/factionrole list</code> - Shows current Faction ID -> Role mappings.</li>
                 </ul>
            </div>

            <div class="command-section">
                 <h3>Managing Global Settings</h3>
                 <ul>
                    <li><strong>Toggle Features:</strong>
                        <ul class="list-disc ml-6 mt-1">
                            <li><code>/settings toggle_hospital [enabled: True/False]</code></li>
                            <li><code>/settings toggle_revive_list [enabled: True/False]</code></li>
                            <li><code>/settings toggle_travel [enabled: True/False]</code></li>
                        </ul>
                    </li>
                    <li><strong>Set Hospital Ping Times:</strong> <code>/settings set_hospital_ping_times</code> - Opens pop-up to set notification times (minutes before exit).</li>
                    <li><strong>Set Travel Check Interval:</strong> <code>/settings set_travel_interval [interval: Seconds]</code> - Sets API check frequency (min 30s).</li>
                    <li><strong>Set Travel Message Auto-Delete:</strong> <code>/settings set_travel_message_delay [minutes: 0-60]</code> - Sets delay before travel notifications are deleted (0=disable).</li>
                    <li><strong>Show All Settings:</strong> <code>/settings show</code> - Displays a summary of global settings.</li>
                 </ul>
            </div>

            <div class="command-section">
                 <h3>Admin Verification Tools</h3>
                 <ul>
                    <li><strong>Verify All Members:</strong> <code>/verifyall</code> - Checks all server members, verifies linked accounts, updates details, and cleans up stale entries.</li>
                    <li><strong>Re-verify Member (Context Menu):</strong> Right-click user -> Apps -> Reverify Torn User - Forces a re-check for one user.</li>
                 </ul>
            </div>

            <div class="command-section">
                 <h3>Payment Status</h3>
                 <ul>
                    <li><strong>Check Status:</strong> <code>/payment status</code> - Shows server subscription status and expiry.</li>
                    <li><strong>View History:</strong> <code>/payment history</code> - Shows recent payment/override history.</li>
                 </ul>
            </div>
        </section>

        <footer>
            If you encounter issues or have questions, please contact the server administrators or the bot owner.
        </footer>

    </div>
</body>
</html>
